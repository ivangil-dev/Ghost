<div class="flex flex-column h-100 items-center overflow-auto" data-test-modal="update-flow">
    <header class="gh-publish-header">
        <button class="gh-btn-editor gh-publish-back-button" title="Cerrar" type="button" {{on "click" @close}}>
            <span>{{svg-jar "arrow-left"}} Editor</span>
        </button>
        <div class="flex">
            {{#let @data.publishOptions.post as |post|}}
                {{#if (not (and post.isSent (not post.isPublished)))}}
                    <button class="gh-btn gh-btn-editor darkgrey gh-unpublish-trigger active" title="Cerrar" type="button" {{on "click" @close}}>
                        <span>{{if post.isScheduled "Desprogramar" "Retirar publicación"}}</span>
                    </button>
                {{/if}}
            {{/let}}
            <div class="settings-menu-toggle-spacer"></div>
        </div>
    </header>

    {{#let @data.publishOptions.post as |post|}}
        <div class="gh-publish-settings-container gh-update-flow fade-in">
            <div class="gh-publish-title" data-test-update-flow-title>
                {{#if (and post.isSent (not post.isPublished))}}
                    Este artículo estaba
                    <span class="green">{{post.status}} por correo electrónico</span>
                {{else}}
                    Este artículo ha sido
                    <span class="green">{{post.status}}</span>
                {{/if}}
            </div>

            <div class="gh-publish-confirmation" data-test-update-flow-confirmation>
                <p>
                    Tu artículo

                    {{if post.isScheduled "estará" "estaba"}}

                    {{#if
                        (or post.hasBeenEmailed
                            post.willEmail
                        )
                    }}
                        {{#if post.emailOnly}}
                            enviado a
                        {{else}}
                            publicado y enviado a
                        {{/if}}

                        {{#if post.isScheduled}}
                            {{#let (members-count-fetcher query=(hash filter=post.fullRecipientFilter)) as |countFetcher|}}
                                <strong>{{gh-pluralize countFetcher.count "suscriptor"}}</strong>
                                {{#if this.showNewsletterName}}de <strong>{{post.newsletter.name}}</strong>{{/if}}
                            {{/let}}
                        {{else}}
                            <strong>{{gh-pluralize post.email.emailCount "suscriptor"}}</strong>
                            {{#if this.showNewsletterName}}de <strong>{{post.newsletter.name}}</strong>{{/if}}
                        {{/if}}
                    {{else}}
                        publicado en tu sitio
                    {{/if}}

                    {{#let (moment-site-tz post.publishedAtUTC) as |publishedAt|}}
                        en
                        {{moment-format publishedAt "DD MM YYYY"}}
                        a
                        {{moment-format publishedAt "HH:mm"}}.
                    {{/let}}

                    {{#if post.isScheduled}}
                        {{#if (and post.isScheduled post.email)}}
                            Esta publicación fue enviada previamente por correo electrónico a

                            <strong>{{pluralize post.email.emailCount "suscriptor"}}</strong>

                            {{#if this.showNewsletterName}}
                                de <strong>{{post.newsletter.name}}</strong>
                            {{/if}}

                            {{#let (moment-site-tz post.email.createdAtUTC) as |sentAt|}}
                                en
                                {{moment-format sentAt "DD MM YYYY"}}
                                a
                                {{moment-format sentAt "HH:mm"}}.
                            {{/let}}
                        {{/if}}

                        <br><br>
                        ¿Necesitas hacer un cambio?
                        <button
                            type="button"
                            class="gh-revert-to-draft"
                            {{on "click" (fn @close (hash afterTask="revertToDraftTask"))}}
                            data-test-button="revert-to-draft"
                        >
                            <span>Desprogramar y revertir a borrador &rarr;</span>
                        </button>
                    {{else if (not post.emailOnly)}}
                        <br><br>
                        <button
                            type="button"
                            class="gh-revert-to-draft"
                            {{on "click" (fn @close (hash afterTask="revertToDraftTask"))}}
                            data-test-button="revert-to-draft"
                        >
                            <span>Retirar publicación y convertir en borrador privado &rarr;</span>
                        </button>
                    {{/if}}
                </p>
            </div>
        </div>
    {{/let}}
</div>
